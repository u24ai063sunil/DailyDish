{% extends 'base.html' %}
{% block title %}{{ user.username }}'s Profile - DailyDish{% endblock %}

{% block content %}
<div style="max-width: 1000px; margin: 0 auto;">
  
  <!-- Profile Header Card -->
  <div class="recipe-card" style="margin-bottom: 40px;">
    <div style="display: grid; grid-template-columns: auto 1fr; gap: 30px; align-items: start;">
      
      <!-- Profile Picture -->
      <div style="text-align: center;">
        {% if profile.profile_picture %}
          <img src="{{ profile.profile_picture.url }}" alt="{{ user.username }}" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 4px solid var(--primary-color); box-shadow: 0 0 30px rgba(0, 255, 200, 0.3);">
        {% else %}
          <div style="width: 150px; height: 150px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), var(--primary-hover)); display: flex; align-items: center; justify-content: center; font-size: 4rem; color: #000; font-weight: 900; box-shadow: 0 0 30px rgba(0, 255, 200, 0.3);">
            {{ user.username.0|upper }}
          </div>
        {% endif %}
      </div>

      <!-- Profile Info -->
      <div>
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
          <div>
            <h1 style="margin-bottom: 5px;">{{ user.get_full_name|default:user.username }}</h1>
            {% if user.get_full_name %}
              <p style="color: var(--text-muted); font-size: 1.1rem; margin-bottom: 10px;">@{{ user.username }}</p>
            {% endif %}
          </div>
          <a href="{% url 'edit_profile' %}" style="padding: 12px 24px; background: linear-gradient(135deg, var(--primary-color), var(--primary-hover)); color: #000; border-radius: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; box-shadow: 0 4px 15px rgba(0, 255, 200, 0.3); transition: all 0.3s ease;">
            ✏️ Edit Profile
          </a>
        </div>

        <div style="display: flex; gap: 30px; margin-bottom: 20px; flex-wrap: wrap;">
          <div>
            <div style="font-size: 2rem; font-weight: 900; color: var(--primary-color);">{{ recipe_count }}</div>
            <div style="color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">Recipes</div>
          </div>
          <div>
            <div style="font-size: 2rem; font-weight: 900; color: var(--secondary-color);">{{ user.date_joined|date:"M Y" }}</div>
            <div style="color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">Member Since</div>
          </div>
        </div>

        {% if profile.bio %}
          <p style="color: var(--text-secondary); line-height: 1.7; margin-bottom: 15px; padding: 15px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; border-left: 3px solid var(--primary-color);">
            {{ profile.bio }}
          </p>
        {% endif %}

        <div style="display: flex; gap: 25px; flex-wrap: wrap; margin-top: 20px;">
          {% if profile.location %}
            <div style="display: flex; align-items: center; gap: 8px; color: var(--text-secondary);">
              <i class="fas fa-map-marker-alt" style="color: var(--primary-color);"></i>
              <span>{{ profile.location }}</span>
            </div>
          {% endif %}
          {% if profile.favorite_cuisine %}
            <div style="display: flex; align-items: center; gap: 8px; color: var(--text-secondary);">
              <i class="fas fa-heart" style="color: var(--secondary-color);"></i>
              <span>{{ profile.favorite_cuisine }}</span>
            </div>
          {% endif %}
          <div style="display: flex; align-items: center; gap: 8px; color: var(--text-secondary);">
            <i class="fas fa-envelope" style="color: var(--accent-color);"></i>
            <span>{{ user.email }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- My Recipes Section -->
  <div style="margin-bottom: 30px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
      <h2 style="margin: 0;">My Recipes</h2>
      <a href="{% url 'add_recipe' %}" style="padding: 10px 20px; background: rgba(0, 255, 200, 0.1); color: var(--primary-color); border: 2px solid var(--primary-color); border-radius: 8px; font-weight: 700; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s ease;">
        ➕ Add New Recipe
      </a>
    </div>

    {% if user_recipes %}
      <div style="display: grid; gap: 25px;">
        {% for recipe in user_recipes %}
          <div class="recipe-card" style="display: grid; grid-template-columns: 1fr auto; gap: 20px; align-items: start;">
            <div>
              <h3 style="margin-bottom: 10px;">
                <a href="#" style="color: var(--primary-color); text-decoration: none;">{{ recipe.title }}</a>
              </h3>
              
              <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                <span class="badge" style="background: var(--primary-color); color: #000;">{{ recipe.category }}</span>
                <span class="badge badge-{{ recipe.difficulty|lower }}">{{ recipe.difficulty }}</span>
                {% if recipe.is_vegan %}
                  <span class="badge badge-vegan">Vegan</span>
                {% elif recipe.is_vegetarian %}
                  <span class="badge badge-veg">Vegetarian</span>
                {% endif %}
                {% if recipe.cuisine %}
                  <span class="badge" style="background: rgba(255, 255, 255, 0.1); color: var(--text-primary);">{{ recipe.cuisine }}</span>
                {% endif %}
              </div>

              {% if recipe.description %}
                <p style="color: var(--text-secondary); margin-bottom: 15px; line-height: 1.6;">
                  {{ recipe.description|truncatewords:30 }}
                </p>
              {% endif %}

              <div style="display: flex; gap: 20px; color: var(--text-muted); font-size: 0.9rem;">
                <span><i class="fas fa-clock" style="color: var(--primary-color);"></i> Prep: {{ recipe.prep_time }}min</span>
                <span><i class="fas fa-fire" style="color: var(--secondary-color);"></i> Cook: {{ recipe.cook_time }}min</span>
                <span><i class="fas fa-users" style="color: var(--accent-color);"></i> Serves: {{ recipe.servings }}</span>
                <span><i class="fas fa-calendar" style="color: var(--text-muted);"></i> {{ recipe.created_at|date:"M d, Y" }}</span>
              </div>
            </div>

            <div style="display: flex; gap: 10px;">
              <a href="#" style="padding: 10px 16px; background: rgba(0, 255, 200, 0.1); color: var(--primary-color); border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; white-space: nowrap;">
                View
              </a>
              {% if recipe.author == user %}
                <form method="post" action="{% url 'delete_recipe' recipe.pk %}" style="margin: 0;" onsubmit="return confirm('Are you sure you want to delete this recipe?');">
                  {% csrf_token %}
                  <button type="submit" style="width: auto; padding: 10px 16px; background: rgba(248, 113, 113, 0.1); color: var(--danger); border: 2px solid var(--danger); font-size: 0.95rem; white-space: nowrap;">
                    Delete
                  </button>
                </form>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="recipe-card" style="text-align: center; padding: 60px 30px;">
        <i class="fas fa-utensils" style="font-size: 4rem; color: var(--text-muted); margin-bottom: 20px; opacity: 0.3;"></i>
        <h3 style="color: var(--text-muted); margin-bottom: 15px;">No recipes yet</h3>
        <p style="color: var(--text-muted); margin-bottom: 25px;">Start sharing your culinary creations with the community!</p>
        <a href="{% url 'add_recipe' %}" style="display: inline-block; padding: 14px 28px; background: linear-gradient(135deg, var(--primary-color), var(--primary-hover)); color: #000; border-radius: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; text-decoration: none; box-shadow: 0 4px 15px rgba(0, 255, 200, 0.3);">
          ➕ Add Your First Recipe
        </a>
      </div>
    {% endif %}
  </div>
</div>

<style>
  @media (max-width: 768px) {
    .recipe-card > div:first-child {
      grid-template-columns: 1fr !important;
      text-align: center;
    }
    
    .recipe-card > div:first-child > div:last-child {
      text-align: left;
    }

    .recipe-card[style*="grid-template-columns: 1fr auto"] {
      grid-template-columns: 1fr !important;
    }

    .recipe-card[style*="grid-template-columns: 1fr auto"] > div:last-child {
      display: flex;
      gap: 10px;
      justify-content: stretch;
    }

    .recipe-card[style*="grid-template-columns: 1fr auto"] > div:last-child > * {
      flex: 1;
    }
  }
</style>
{% endblock %}